#js sha1加密算法实现

        W.sha1=new function(){var m=0;var a="";var j=8;this.hex_sha1=function(o){return l(d(h(o),o.length*j))};this.b64_sha1=function(o){return k(d(h(o),o.length*j))};this.str_sha1=function(o){return c(d(h(o),o.length*j))};this.hex_hmac_sha1=function(o,p){return l(n(o,p))};this.b64_hmac_sha1=function(o,p){return k(n(o,p))};this.str_hmac_sha1=function(o,p){return c(n(o,p))};function g(){return hex_sha1("abc")=="a9993e364706816aba3e25717850c26c9cd0d89d"}function d(E,y){E[y>>5]|=128<<(24-y%32);E[((y+64>>9)<<4)+15]=y;var F=Array(80);var D=1732584193;var C=-271733879;var B=-1732584194;var A=271733878;var z=-1009589776;for(var s=0;s<E.length;s+=16){var v=D;var u=C;var r=B;var q=A;var o=z;for(var p=0;p<80;p++){if(p<16){F[p]=E[s+p]}else{F[p]=f(F[p-3]^F[p-8]^F[p-14]^F[p-16],1)}var G=i(i(f(D,5),b(p,C,B,A)),i(i(z,F[p]),e(p)));z=A;A=B;B=f(C,30);C=D;D=G}D=i(D,v);C=i(C,u);B=i(B,r);A=i(A,q);z=i(z,o)}return Array(D,C,B,A,z)}function b(p,o,r,q){if(p<20){return(o&r)|((~o)&q)}if(p<40){return o^r^q}if(p<60){return(o&r)|(o&q)|(r&q)}return o^r^q}function e(o){return(o<20)?1518500249:(o<40)?1859775393:(o<60)?-1894007588:-899497514}function n(q,t){var s=h(q);if(s.length>16){s=d(s,q.length*j)}var o=Array(16),r=Array(16);for(var p=0;p<16;p++){o[p]=s[p]^909522486;r[p]=s[p]^1549556828}var u=d(o.concat(h(t)),512+t.length*j);return d(r.concat(u),512+160)}function i(o,r){var q=(o&65535)+(r&65535);var p=(o>>16)+(r>>16)+(q>>16);return(p<<16)|(q&65535)}function f(o,p){return(o<<p)|(o>>>(32-p))}function h(r){var q=Array();var o=(1<<j)-1;for(var p=0;p<r.length*j;p+=j){q[p>>5]|=(r.charCodeAt(p/j)&o)<<(24-p%32)}return q}function c(q){var r="";var o=(1<<j)-1;for(var p=0;p<q.length*32;p+=j){r+=String.fromCharCode((q[p>>5]>>>(24-p%32))&o)}return r}function l(q){var p=m?"0123456789ABCDEF":"0123456789abcdef";var r="";for(var o=0;o<q.length*4;o++){r+=p.charAt((q[o>>2]>>((3-o%4)*8+4))&15)+p.charAt((q[o>>2]>>((3-o%4)*8))&15)}return r}function k(r){var q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var t="";for(var p=0;p<r.length*4;p+=3){var s=(((r[p>>2]>>8*(3-p%4))&255)<<16)|(((r[p+1>>2]>>8*(3-(p+1)%4))&255)<<8)|((r[p+2>>2]>>8*(3-(p+2)%4))&255);for(var o=0;o<4;o++){if(p*8+o*6>r.length*32){t+=a}else{t+=q.charAt((s>>6*(3-o))&63)}}}return t}};